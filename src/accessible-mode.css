/**
 * Contrast modes – applied when [data-contrast] is set on the document root.
 * All pairs meet WCAG 2 AA (axe color-contrast): 4.5:1 normal text, 3:1 large text.
 * See: https://dequeuniversity.com/rules/axe/4.11/color-contrast
 */

/* ---------------------------------------------------------------------------
   High contrast – WCAG 1.4.3 (Minimum): 4.5:1 normal, 3:1 large
   --------------------------------------------------------------------------- */
:root[data-contrast="high"] {
  --bg-primary: #ffffff;
  --bg-secondary: #f0f0f0;
  --bg-tertiary: #e5e5e5;
  --text-primary: #1a1a1a;   /* ~12.6:1 on bg-primary */
  --text-secondary: #333333; /* ~10.7:1 on bg-primary */
  --text-tertiary: #525252;   /* ~5.7:1 on bg-primary, ≥4.5:1 */
  --border-color: rgba(0, 0, 0, 0.45);
  --gradient-bg: linear-gradient(180deg, #f0f0f0 0%, #ffffff 100%);
}

:root[data-contrast="high"][data-theme="dark"] {
  --bg-primary: #0d0d0d;
  --bg-secondary: #1a1a1a;
  --bg-tertiary: #262626;
  --text-primary: #f8fafc;   /* ~14:1 on bg-primary */
  --text-secondary: #e2e8f0; /* ~12:1 on bg-primary */
  --text-tertiary: #cbd5e1;   /* ~9:1 on bg-primary, ≥4.5:1 */
  --border-color: rgba(255, 255, 255, 0.4);
  --gradient-bg: linear-gradient(180deg, #0d0d0d 0%, #1a1a1a 100%);
}

/* ---------------------------------------------------------------------------
   Low contrast – softer palette, still WCAG AA (≥4.5:1 on lightest bg)
   --------------------------------------------------------------------------- */
:root[data-contrast="low"] {
  --bg-primary: #fafafa;
  --bg-secondary: #f5f5f5;
  --bg-tertiary: #eeeeee;
  --text-primary: #374151;   /* ~8:1 on bg-primary */
  --text-secondary: #4b5563; /* ~6.2:1 on bg-primary */
  --text-tertiary: #5c6570;   /* ~4.6:1 on bg-primary, ≥4.5:1 */
  --border-color: rgba(0, 0, 0, 0.22);
  --gradient-bg: linear-gradient(180deg, #f5f5f5 0%, #fafafa 100%);
}

:root[data-contrast="low"][data-theme="dark"] {
  --bg-primary: #1a1a1a;
  --bg-secondary: #242424;
  --bg-tertiary: #2e2e2e;
  --text-primary: #d1d5db;   /* ~10:1 on bg-primary */
  --text-secondary: #9ca3af; /* ~7:1 on bg-primary */
  --text-tertiary: #9ca3af;  /* ≥4.5:1 on bg-tertiary (was #6b7280, failed) */
  --border-color: rgba(255, 255, 255, 0.2);
  --gradient-bg: linear-gradient(180deg, #1a1a1a 0%, #242424 100%);
}

/* ---------------------------------------------------------------------------
   Focus visible – WCAG 2.4.11 (min 3:1 contrast, at least 2px thick)
   --------------------------------------------------------------------------- */
[data-contrast="high"] :focus {
  outline: 2px solid transparent;
}

[data-contrast="high"] :focus-visible {
  outline: 3px solid currentColor;
  outline-offset: 2px;
}

[data-contrast="high"] :focus:not(:focus-visible) {
  outline: none;
}

:root[data-contrast="high"] :focus-visible {
  outline-color: #0047ab;
}

:root[data-contrast="high"][data-theme="dark"] :focus-visible {
  outline-color: #60a5fa;
}

/* ---------------------------------------------------------------------------
   Links – identifiable without relying on color alone (underline)
   --------------------------------------------------------------------------- */
[data-contrast="high"] a {
  text-decoration-thickness: 2px;
  text-underline-offset: 0.2em;
}

[data-contrast="high"] a:hover,
[data-contrast="high"] a:focus-visible {
  text-decoration-style: solid;
}

[data-contrast="high"] a:not([class]) {
  text-decoration: underline;
}

/* Nav/footer links often use .nav-link / .footer-link; ensure underline on focus/hover */
[data-contrast="high"] .nav-link,
[data-contrast="high"] .footer-link {
  text-decoration: underline;
  text-decoration-color: currentColor;
  text-decoration-thickness: 2px;
}

[data-contrast="high"] .nav-link:hover,
[data-contrast="high"] .footer-link:hover {
  text-decoration-color: inherit;
}

/* ---------------------------------------------------------------------------
   Touch targets – minimum 44×44px (WCAG 2.5.5 Level AAA, Apple HIG)
   --------------------------------------------------------------------------- */
[data-contrast="high"] button,
[data-contrast="high"] .btn,
[data-contrast="high"] .theme-toggle,
[data-contrast="high"] .language-switch-option,
[data-contrast="high"] .accessible-toggle,
[data-contrast="high"] .nav-button,
[data-contrast="high"] .nav-sign-in-btn,
[data-contrast="high"] .nav-link,
[data-contrast="high"] a[href].nav-link {
  min-height: 44px;
  min-width: 44px;
}

[data-contrast="high"] .theme-toggle,
[data-contrast="high"] .language-switch-option,
[data-contrast="high"] .language-switch-mobile,
[data-contrast="high"] .accessible-toggle {
  padding: 0.5rem 1rem;
}

[data-contrast="high"] .nav-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.5rem 1rem;
}

[data-contrast="high"] input:not([type="hidden"]),
[data-contrast="high"] select,
[data-contrast="high"] textarea {
  min-height: 44px;
  padding: 0.5rem 0.75rem;
}

/* ---------------------------------------------------------------------------
   Typography – readable body text and line height
   --------------------------------------------------------------------------- */
[data-contrast="high"] body {
  line-height: 1.6;
  font-size: 1rem;
}

[data-contrast="high"] p,
[data-contrast="high"] .hero-description,
[data-contrast="high"] .feature-description,
[data-contrast="high"] .footer-text,
[data-contrast="high"] .section-subtitle {
  line-height: 1.7;
}

/* ---------------------------------------------------------------------------
   Reduced motion – respect prefers-reduced-motion in accessible mode
   --------------------------------------------------------------------------- */
@media (prefers-reduced-motion: reduce) {
  [data-contrast="high"] *,
  [data-contrast="high"] *::before,
  [data-contrast="high"] *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* In accessible mode, reduce decorative motion even without user preference */
[data-contrast="high"] .floating-card,
[data-contrast="high"] [class*="float"] {
  animation: none;
}

[data-contrast="high"] .country-card:hover,
[data-contrast="high"] .feature-card:hover,
[data-contrast="high"] .country-select-btn:hover,
[data-contrast="high"] .nav-button:hover,
[data-contrast="high"] .nav-sign-in-btn:hover,
[data-contrast="high"] .theme-toggle:hover,
[data-contrast="high"] .language-switch-option:hover,
[data-contrast="high"] .language-switch-mobile:hover,
[data-contrast="high"] .accessible-toggle:hover,
[data-contrast="high"] button:hover,
[data-contrast="high"] .btn:hover,
[data-contrast="high"] .hero-buttons a:hover,
[data-contrast="high"] .hero-buttons button:hover {
  transform: none;
}

[data-contrast="high"] .app {
  animation: none;
}

/* ---------------------------------------------------------------------------
   Text size (IS 5568 – resizable text)
   --------------------------------------------------------------------------- */
:root[data-font-size="110"] {
  font-size: 110%;
}

:root[data-font-size="125"] {
  font-size: 125%;
}

:root[data-font-size="150"] {
  font-size: 150%;
}

/* ---------------------------------------------------------------------------
   Reduce motion (IS 5568 / WCAG 2.1 – user control)
   --------------------------------------------------------------------------- */
[data-reduce-motion="true"] *,
[data-reduce-motion="true"] *::before,
[data-reduce-motion="true"] *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
}

/* ---------------------------------------------------------------------------
   Monochrome mode – grayscale display (user preference)
   --------------------------------------------------------------------------- */
:root[data-monochrome="true"] {
  filter: grayscale(100%);
}
